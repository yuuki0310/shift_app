<div id="wrapper">
<% available_staff = {} %>
<%= month_calendar do |date| %>
  <%= date.day %>
  <table>
    <% date_table(date).each do |dt| %>
      <% available_staff.store("#{date.day}-#{dt.working_time_from.strftime( "%H:%M" )}", [[]]) %>
      <tr>
          <td><%= dt.working_time_from.strftime( "%H:%M" ) %></td>
          <td rowspan="2">
            <%= "#{dt.count}äºº" %>
            <% available_staff["#{date.day}-#{dt.working_time_from.strftime( "%H:%M" )}"].unshift(dt.count) %>
            <% store_date_table(date).each do |wtf, users| %>
              <% if wtf == dt.working_time_from %>
                <% users.each do |u| %>
                  <% available_staff["#{date.day}-#{dt.working_time_from.strftime( "%H:%M" )}"][1].push(u.name) %>
                  <%= u.name %>
                <% end %>
              <% end %>          
            <% end %>
          </td>
        </tr>
        <tr>
          <td><%= dt.working_time_to.strftime( "%H:%M" ) %></td>
        </tr>
    <% end %>
  </table>
<% end %>
<%= available_staff %>
</div>
