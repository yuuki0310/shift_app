<div id="wrapper">
<% available_staff = [] %>
<%= month_calendar do |date| %>
  <%= date.day %>
  <table>
    <% date_table(date).each do |dt| %>
      <tr>
        <td><%= dt.working_time_from.strftime( "%H:%M" ) %></td>
        <td rowspan="2">
          <%= "#{dt.count}äºº" %>
          <% store_date_table(date).each do |wtf, names| %>
            <% if wtf == dt.working_time_from %>
              <% available_staff.push({date: "#{date.day}-#{wtf.strftime( "%H:%M" )}", count: dt.count, names: names}) %>
              <% names.each do |n| %>
                <%= n %>
              <% end %>
            <% end %>          
          <% end %>
        </td>
      </tr>
      <tr>
        <td><%= dt.working_time_to.strftime( "%H:%M" ) %></td>
      </tr>
    <% end %>
  </table>
<% end %>
<%# available_staff.sort! do |a, b|
  a[:working_time_from].to_time <=> b[:working_time_from].to_time
end %>
<%= available_staff %>
</div>
